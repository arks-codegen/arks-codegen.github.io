<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Pipeline for retrieval-augmented code generation">
  <meta name="keywords" content="retrieval, code generation">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Retrieval-Augmented Code Generation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://hkunlp.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://yale-lily.github.io/spider">
            Spider
          </a>
          <a class="navbar-item" href="https://github.com/HKUNLP/UnifiedSKG">
            UnifiedSKG
          </a>
          <a class="navbar-item" href="https://github.com/Yushi-Hu/IC-DST">
            IC-DST
          </a>
          <a class="navbar-item" href="https://github.com/HKUNLP/icl-selective-annotation">
            Selective Annotation
          </a>
          <a class="navbar-item" href="https://ds1000-code-gen.github.io/">
            DS-1000
          </a>
          <a class="navbar-item" href="https://lm-code-binder.github.io/">
            Binder
          </a>
            <a class="navbar-item" href="https://instructor-embedding.github.io/">
              Instructor
            </a>
            <a class="navbar-item" href="https://text-to-reward.github.io/">
              Text2Reward
            </a>
            <a class="navbar-item" href="https://github.com/xlang-ai/OpenAgents">
              OpenAgents
            </a>
            <a class="navbar-item" href="https://github.com/OpenLemur/lemur">
              Lemur-70B
            </a>
            <a class="navbar-item" href="https://os-world.github.io/">
              OSWorld
            </a>
          </div>
      </div>
    </div>

  </div>
</nav>

<!-- <nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://hkunlp.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://yale-lily.github.io/spider">
            Spider
          </a>
          <a class="navbar-item" href="https://github.com/HKUNLP/UnifiedSKG">
            UnifiedSKG
          </a>
          <a class="navbar-item" href="https://github.com/Yushi-Hu/IC-DST">
            IC-DST
          </a>
          <a class="navbar-item" href="https://github.com/HKUNLP/icl-selective-annotation">
            Selective Annotation
          </a>
          <a class="navbar-item" href="https://ds1000-code-gen.github.io/">
            DS-1000
          </a>
          <a class="navbar-item" href="https://lm-code-binder.github.io/">
            Binder
          </a>
        </div>
      </div>
    </div>

  </div>
</nav> -->


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">EVOR: Evolving Retrieval for Code Generation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://hongjin-su.github.io/">Hongjin Su</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=slwTiOUAAAAJ">Shuyang Jiang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://halfrot.github.io/">Yuhang Lai</a><sup>2</sup>,</span><br>
            <span class="author-block">
              Haoyuan Wu<sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://bowie.shiboao.top/">Boao Shi</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://cheissmart.github.io/">Che Liu</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://siviltaram.github.io/">Qian Liu</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://taoyds.github.io/">Tao Yu</a><sup>1</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>The University of Hong Kong,</span>
            <span class="author-block"><sup>2</sup>Fudan University,</span>
            <span class="author-block"><sup>3</sup>Sea AI Lab</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2402.12317"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/xlang-ai/arks"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Twitter Link. -->
              <!-- <span class="link-block">
                <a href="https://huggingface.co/spaces/mteb/leaderboard"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fa fa-book"></i>
                  </span>
                  <span>Leaderboard</span>
                  </a>
              </span> -->
              <!-- <span class="link-block">
                <a href="https://huggingface.co/hkunlp/instructor-large"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Checkpoint</span>
                  </a>
              </span> -->
              <span class="link-block">
                <a href="https://github.com/hongjin-su/arks_dev"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-twitter"></i>
                  </span>
                  <span>Twitter</span>
                  </a>
              </span>
              <span class="link-block">
                <a href="https://huggingface.co/datasets/xlangai/arks_data"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-clone"></i>
                  </span>
                  <span>Data</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>
  
<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="subtitle has-text-centered">
        Recently the retrieval-augmented generation (RAG) has been successfully applied in code generation. However, existing pipelines for retrieval-augmented code generation (RACG) employ static knowledge bases with a single source, limiting the adaptation capabilities of Large Language Models (LLMs) to domains they have insufficient knowledge of. In this work, we develop a novel pipeline, EVOR, that employs the synchronous evolution of both queries and diverse knowledge bases. On two realistic settings where the external knowledge is required to solve code generation tasks, we compile four new datasets associated with frequently updated libraries and long-tail programming languages, named EVOR-BENCH. Extensive experiments demonstrate that EVOR achieves two to four times of execution accuracy compared to other methods such as Reflexion (Shinn et al., 2024), DocPrompting (Zhou et al., 2023), etc. We demonstrate that EVOR is flexible and can be easily combined with them to achieve further improvement. Further analysis reveals that EVOR benefits from the synchronous evolution of queries and documents and the diverse information sources in the knowledge base. We hope that our studies will inspire more insights into the design of advanced RACG pipelines in future research.
      </h2>
      <p align="center">
        <img src="static/images/arks.png" width="70%" align="middle" class="center"/> <!-- To .gif format-->
      </p>

    </div>
  </div>
</section>

  
 <section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Recently the retrieval-augmented generation (RAG) paradigm has raised much attention for its potential in incorporating external knowledge into large language models (LLMs) without further training. While widely explored in natural language applications, its utilization in code generation remains under-explored. In this paper, we introduce Active Retrieval in Knowledge Soup (ARKS), an advanced strategy for generalizing large language models for code. In contrast to relying on a single source, we construct a knowledge soup integrating web search, documentation, execution feedback, and evolved code snippets. We employ an active retrieval strategy that iteratively refines the query and updates the knowledge soup. To assess the performance of ARKS, we compile a new benchmark comprising realistic coding problems associated with frequently updated libraries and long-tail programming languages. Experimental results on ChatGPT and CodeLlama demonstrate a substantial improvement in the average execution accuracy of ARKS on LLMs. The analysis confirms the effectiveness of our proposed knowledge soup and active retrieval strategies, offering rich insights into the construction of effective RACG pipelines.
          </p>
          <span class="dnerf">Arks</span> is effective because:
        <ul>
          <li><strong>Knowledge soup:</strong> &nbsp Diverse knowledge soup consists of not only documentation, but also more resources including web search, code snippets and execution feedback</li>
          <li><strong>Query Formulation:</strong> &nbsp Apart from natural language question, Arks employ the explained code as more informative query, which helps retrieval models match desired knowledge source </li>
          <li><strong>Active Retrieval:</strong> &nbsp Compared to RAG, we actively refine query and knowledge soup, which helps to retrieve more relevant information</li>
          <li><strong>Performance:</strong> &nbsp Across all datasets, ChatGPT and CodeLlama achieve performance gain of 24.0% and 23.8% respectively, compared to the vanilla setting without knowledge augmentation </li>
        </ul>
        </div>
      </div>
    </div>
  </div>
    <!--/ Abstract. -->
  </div>
</section>
  
<section class="section">
  <div class="container is-max-desktop">
    <!-- Results. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Main Results</h2>
        <div class="content has-text-justified">
          <p>
            <span class="dnerf">Diverse resources in general help LLM generalization.
          </p>
        <!-- <ul>
          <li><a href="https://huggingface.co/spaces/mteb/leaderboard">MTEB</a> (56 diverse datasets including BEIR, STS, etc.)</li>
          <li><a href="https://arxiv.org/abs/2112.04139">Billboard</a> (Evaluate test generation quality)</li>
          <li><a href="https://arxiv.org/abs/2209.01975">Prompt Retrieval</a> (Retrieve examples for in-context learning) </li>
        </ul> -->
          <img src="static/images/main_result_arks.png" class="center">
          <p>
            ChatGPT and CodeLlama execution accuracy with different knowledge sources. Tensor-M refers to Tensorflow-M and Avg. refers to the average score across four benchmarks. Web denotes the web search content; Exec denotes the execution feedback from compiler/interpreter; Code denotes the code snippets generated by LLMs in previous rounds that are verified to be free of syntax error; Doc refers to the documentation. Adding more knowledge sources consistently enhances the performance, which demonstrates the advantage of a diverse knowledge soup in the RACG pipeline.
          </p>
        </div>
      </div>
    </div>
  </div>
    <!--/ Results. -->

</section>
  
<section class="section">
  <div class="container is-max-desktop">
    <!-- Results. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Analysis</h2>
        <div class="content has-text-justified">
          <p>
            We demonstrate the significant performance increase provided by active retrieval on top of one-time retrieval
          </p>
          <p align="center">
        <img src="static/images/arks_table3.png" width="400" class="center">
      </p>
          <p>
            Next, we show the critical role of both query formulation and retrieval model choice
          </p>
          <p align="center">
        <img src="static/images/arks_figure23.png" class="center">
      </p>
          <p>
            Furthermore, we evaluate the retrieval accuracy, revealing that both retrieval and generator models have large rooms to improve for better generalization
          </p>
         <p align="center">
        <img src="static/images/arks_table4.png" width="400" height="100" class="center">
           </p>
        <p>
            With long-context models and more knowledge included in the prompt, model generalization performance is not guaranteed to improve, calling for more delicate mechanism in RACG pipeline
        </p>
        <p align="center">
          <img src="static/images/arks_figure4.png" width="400" class="center">
        </p>
          <p>
            Last but not least, we perform a case study o provide a more intuitive understanding of the improvement achieved by ARKS on top of LLMs,
          </p>
        <p align="center">
           <img src="static/images/arks_figure5.png" width="400" height="400" class="center"> <!-- To .gif format-->
        </p>
        </div>
      </div>
    </div>
  </div>
    <!--/ Results. -->

</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Dataset Statistics</h2>
        <div class="content has-text-justified">
          <p>
            To evaluate Arks, we curate 4 datasets covering two realistic scenarios of RACG: updated libraries and long-tail programming languages. Here are the data statistics:
          </p>
        <p align="center">
           <img src="static/images/arks_data_statistics.png" width="400" class="center"> <!-- To .gif format-->
        </p>
        </div>
      </div>
    </div>
  </div>
    <!--/ Abstract. -->
  </div>
</section>

<!-- <section class="section">
  <div class="container is-max-desktop content">
    <h2 class="title">Acknowledgement</h2>
   We thank <a href="https://akariasai.github.io/">Akari Asai</a>, Jack Lin, Minghan Li, and <a href="https://noahs-ark.github.io/">the ARK group at UW</a> for their helpful feedback on this work.
  </div>
</section>
 
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{INSTRUCTOR,
  title={One Embedder, Any Task: Instruction-Finetuned Text Embeddings},
  author={Su, Hongjin and Shi, Weijia and Kasai, Jungo and Wang, Yizhong and Hu, Yushi and  Ostendorf, Mari and Yih, Wen-tau and Smith, Noah A. and  Zettlemoyer, Luke and Yu, Tao},
  url={https://arxiv.org/abs/2212.09741},
  year={2022},
}</code></pre>
  </div>
</section> -->

<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>



